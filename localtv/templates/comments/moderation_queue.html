{% extends "localtv/admin/__layouts/25_75.html" %}

{% load i18n filters comments pagetabs %}
{% load url from future %}

{% block body_classes %}{{ block.super }} admin-comments{% endblock %}

{% block title %}{% trans "Comments" %} – {% trans "Admin" %} – {{ block.super }}{% endblock %}

{% block side %}
{% include 'localtv/admin/_admin_navigation.html' %}
{% endblock %}

{% block main %}
  <header class="page-header">
    <h1>{% block page_title %}{% trans 'Comments' %}{% endblock %}</h1>
    <div class="page-actions">
      <ul class="action-list">
        <li><a href="{% url 'localtv_admin_users_create' %}">Add User</a></li>
        <li{% if not request.GET.show %} class="selected"{% endif %}><a href="{% url 'localtv_admin_users' %}">Show All Accounts</a></li>
        <li{% if request.GET.show == "human" %} class="selected"{% endif %}><a href="{% url 'localtv_admin_users' %}?show=humans">Show "Human" Accounts</a></li>
        <li{% if request.GET.show == "nonhuman" %} class="selected"{% endif %}><a href="{% url 'localtv_admin_users' %}?show=nonhumans">Show Other Accounts</a></li>
      </ul>
    </div>
  </header>

{% if empty %}
<p id="nocomments">{% trans "No comments to moderate" %}.</p>

{% else %}
<div id="content-main">
 
 <h2>Comments</h2>
 
  <div class="module" id="labels">
    {% if page_obj %}
    <div class="pag">
      {% pagetabs page_obj %}
    </div>
    {% endif %}
    {% if request.GET.undo %}
    <form method="POST" action="{% url comments-moderation-undo %}">{% csrf_token %}
      <input type="hidden" name="actions" value="{{ request.GET.undo }}">
      <input type="submit" value="Undo">
    </form>
    {% endif %}
    <form method="POST" action="">{% csrf_token %}
      <div class="bulkedit_controls">
        <select id="bulk_action_selector" class="behave" name="bulk_action">
          <option value="">Bulk Actions</option>
          <option value="approve">Approve</option>
          <option value="remove">Remove</option>
        </select>
        <button type="submit" class="med_button"><span>Apply</span></button>
      </div>
      <table cellspacing="0" class="rounded">
        <thead>
          <tr>
            <th><input id="id_select_all" type="checkbox"></th>
            <th><span>{% trans "Name" %}</span></th>
            <th><span>{% trans "Comment" %}</span></th>
            <th><span>{% trans "Email" %}</span></th>
            <th><span>{% trans "URL" %}</span></th>
            <th><span>{% trans "Authenticated?" %}</span></th>
            <th><span>{% trans "IP Address" %}</span></th>
            <th class="sorted desc"><span>{% trans "Date posted" %}</span></th>
            <th><span>{% trans "Video" %}</span></th>
          </tr>
        </thead>
        <tbody>
          {{ formset.management_form }}
          {{ formset.non_form_errors }}
          {% for form in formset.forms %}
          <tr class="{% cycle 'row1' 'row2' %}">
            <td>{{ form.id }}{{ form.BULK }}{{ form.non_field_errors }}</td>
            {% with form.instance as comment %}
            <td>
              {{ comment.name }}
              <div class="actions">
                <input class="approve submit" type="submit" name="{{ form.prefix }}-APPROVE" value="{% trans "Approve" %}" />
                <input class="remove submit" type="submit" name="{{ form.prefix }}-REMOVE" value="{% trans "Remove" %}" />
              </div>
            </td>
            <td>{{ comment.comment|sanitize }}</td>
            <td>{{ comment.email }}</td>
            <td>{{ comment.url }}</td>
            <td>
              {% if comment.user %}{% trans "yes" %}{% else %}{% trans "no" %}{% endif %}
            </td>
            <td>{{ comment.ip_address }}</td>
            <td>{{ comment.submit_date|date:"F j, P" }}</td>
            <td><a href="{% get_comment_permalink comment %}">{{ comment.content_object }}</a></td>
            {% endwith %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </form>
  </div>
</div>
{% endif %}
<script type="text/javascript">
  $("#id_select_all").click(function() {
  $("input[type=checkbox]").attr('checked', this.checked);
  });
</script>
{% endblock %}
