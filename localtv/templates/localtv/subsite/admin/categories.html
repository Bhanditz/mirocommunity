{% comment %}
# Miro Community
# Copyright 2009 - Participatory Culture Foundation
# 
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as
# published by the Free Software Foundation, either version 3 of the
# License, or (at your option) any later version.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
# 
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% extends "localtv/subsite/admin/base.html" %}

{% load i18n versioned %}

{% block head %}
  {{ block.super }}
  <script type="text/javascript" src="{% versioned "/js/urlify.js" %}"></script>
  <script type="text/javascript">
      function edit_category(event) {
          if (event.target.nodeName === 'INPUT') {
              return false;
          }
          $(event.target).parent().hide().next().show();
      }
  </script>
{% endblock %}
{% block title %}{{ block.super }} - {% trans "Admin - Categories" %}{% endblock %}

{% block body_class %}category_admin{% endblock body_class %}

{% block content %}
  <div id="label_sidebar" class="rounded">
    <h1>Add a Category</h1>
    <form action="" method="POST">
      {{ add_category_form.as_p }}
      <input type="submit" value="Add" name="submit">
    </form>
  </div>

  <div id="labels">
    <form action="" method="POST" enctype="multipart/form-data">
      <div class="actions">
      	<select name="action">
        	<option value="">Bulk Actions</option>
        	<option value="delete">Delete</option>
      	</select>
      	<input type="submit" value="Apply" name="submit"/>
      </div>
      <table class="rounded editable" cellpadding="0" cellspacing="0">
      <thead>
        <tr>
          <th valign="middle" class="checkbox"><input type="checkbox"/></td>
          <th valign="middle"><span>Name</span></th>
          <th valign="middle"><span>Description</span></th>
          <th><span>Slug</span></th>
          <th><span>Videos</span></th>
        </tr>
      </thead>
      {% for category in categories %}
      <tr valign="middle" class="{% cycle "grey" "white" %}" onclick="edit_category(event);" {% if category.form.errors %}style="display: none;"{% endif %}>
      {% include "localtv/subsite/admin/category_row.html" %}
      </tr>
      {% endfor %}
    </table>
    </form>
  </div>

<script type="text/javascript">

    document.getElementById("id_slug").onchange = function() { this._changed = true; };

    document.getElementById("id_name").onkeyup = function() {
        var e = document.getElementById("id_slug");
        if (!e._changed) { e.value = URLify(document.getElementById("id_name").value, 50); }
    }

</script>

{% endblock content %}
