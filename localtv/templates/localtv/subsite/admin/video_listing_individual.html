{% load i18n localtv_thumbnail %}

<div {% ifequal video current_video %}
       class="video hoverable selected"
     {% endifequal %}
     {% ifnotequal video current_video %}
       class="video hoverable unselected"
     {% endifnotequal %}>
  <span class="video_id">{{ video.id }}</span>
  <a class="thumbnail click_to_display"
     {% if video.metasearch_vid %}
       href="{% url localtv_admin_livesearch_display %}?query={{ query_string|urlencode }}&video_id={{ video.id }}&order_by={{ order_by|default:"relevant" }}"
     {% else %}
       href="{% url localtv_admin_preview_video %}?video_id={{ video.id }}"
     {% endif %}>
    <div>
      {% if video.thumbnail_url %}
        <img style="background: url({% get_thumbnail_url video 142 104 %}) no-repeat;" src="/images/vid_overlay.png" />
      {% else %}
        <img src="/images/vid_overlay.png" />
      {% endif %}
    </div>
  </a>
  <div class="title_desc">
    <h3>
      <a class="click_to_display"
         {% if video.metasearch_vid %}
           href="{% url localtv_admin_livesearch_display %}?query={{ query_string|urlencode }}&video_id={{ video.id }}&order_by={{ order_by|default:"relevant" }}"
         {% else %}
           href="{% url localtv_admin_preview_video %}?video_id={{ video.id }}"
         {% endif %}>
        {% if video.name %}
          {{ video.name }}
        {% else %}
          {% trans "(no title)" %}
        {% endif %}
      </a>
    </h3>

    {% autoescape off %}
      <p>{{ video.description|striptags|truncatewords:50 }}</p>
    {% endautoescape %}

    {% if video.when_submitted %}
    <p>Submitted: {{ video.when_submitted|timesince }} ago</p>
    {% endif %}
    {% if video.when %}
    <p>Published: {{ video.when|timesince }} ago</p>
    {% endif %}
  </div>
  
  <div class="approve_reject">
      <a class="feature med_button"
         {% if video.metasearch_vid %}
           href="{% url localtv_admin_livesearch_approve %}?query={{ query_string|urlencode }}&video_id={{ video.id }}&order_by={{ order_by|default:"relevant" }}&feature=true"
         {% else %}
           href="{% url localtv_admin_approve_video_action %}?video_id={{ video.id }}&feature=true"
         {% endif %}><span>Feature</span></a>
    <a class="approve med_button"
       {% if video.metasearch_vid %}
         href="{% url localtv_admin_livesearch_approve %}?query={{ query_string|urlencode }}&video_id={{ video.id }}&order_by={{ order_by|default:"relevant" }}"
       {% else %}
         href="{% url localtv_admin_approve_video_action %}?video_id={{ video.id }}"
       {% endif %}><span>Approve</span></a> 
    {% if not video.metasearch_vid %}
      <a class="reject med_button"
         href="{% url localtv_admin_reject_video_action %}?video_id={{ video.id }}"><span>Reject</span></a>
    {% endif %}
  </div>
</div>
