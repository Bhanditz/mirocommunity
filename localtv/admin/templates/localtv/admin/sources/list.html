{% extends "localtv/admin/list.html" %}

{% comment %}
Copyright 2009 - Participatory Culture Foundation

This file is part of Miro Community.

Miro Community is free software: you can redistribute it and/or modify it
under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or (at your
option) any later version.

Miro Community is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with Miro Community.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}

{% load filters %}

{% block object_list_item_headers %}
{{ block.super }}
<th>Last import</th>
{% endblock %}

{% block object_list_item_fields %}
{{ block.super }}
{% with import=object.feedimport_set.latest %}
  <td>
    {% if import %}
     {{ import.get_status_display }} {% if import.status == import.STARTED %}{{ import.start|simpletimesince }}{% else %}{{ import.last_activity|simpletimesince }}{% endif %} ago

     {% if import.status == import.COMPLETE %}({{ import.videos_imported }} videos imported){% endif %}

     {% if import.status == import.FAILED %}{% with error_count=import.feedimporterror_set.count %}({{ error_count }} error{{ error_count|pluralize }}){% endwith %}{% endif %}
    {% else %}
      No imports found
    {% endif %}</td>
{% endwith %}
{% endblock %}